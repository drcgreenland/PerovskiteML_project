This is the head of a CSV file I have:

    JV_default_Voc  JV_default_Jsc  JV_default_FF  JV_default_PCE  \
0           0.002            0.22           0.57            0.00   
1           0.120            0.49           0.25            0.00   
2           0.135            3.69           0.26            0.13   
3           0.227            1.32           0.41            0.12   
4           0.190            1.57           0.34            0.10   

  Perovskite_band_gap Perovskite_composition_a_ions  \
0                1.27                            Cs   
1                 NaN                            Cs   
2                 NaN                            Cs   
3                 NaN                            Cs   
4                1.75                            Cs   

  Perovskite_composition_a_ions_coefficients Perovskite_composition_b_ions  \
0                                          1                            Sn   
1                                          1                            Sn   
2                                          1                            Sn   
3                                          1                            Sn   
4                                          1                            Sn   

  Perovskite_composition_b_ions_coefficients Perovskite_composition_c_ions  \
0                                          1                             I   
1                                          1                         Br; I   
2                                          1                         Br; I   
3                                          1                         Br; I   
4                                          1                            Br   

  Perovskite_composition_c_ions_coefficients  
0                                          3  
1                                   0.3; 2.7  
2                                   1.5; 1.5  
3                                   2.7; 0.3  
4                                          3  

Create a Python script that changes this CSV file according to the following changes:

The columns 'JV_default_Voc', 'JV_default_Jsc', 'JV_default_FF', 'JV_default_PCE', 'Perovskite_band_gap' can stay the same.

However, I want the columns 'Perovskite_composition_a_ions', 'Perovskite_composition_a_ions_coefficients',
'Perovskite_composition_b_ions', 'Perovskite_composition_b_ions_coefficients',
'Perovskite_composition_c_ions', 'Perovskite_composition_c_ions_coefficients' to be edited.

You see there are ions and their corresponding coefficients stored in the respective columns. 
I want you to change this such that the database no longer specifies the actual site of the ion 
(that is not important for my analysis), 
but instead we have columns that contain all the different types of molecules that can exist on a site, 
and the elements be the corresponding proportion of that molecule that exists in the given perovskite defined by the row. 
You calculate this proportion by using the coefficients.

Firstly, you will need to build a script that goes through the CSV and identifies all the unique molecules and create those as columns,
 then begin to calculate proportions.